!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1);!function(e,t){new e(t),t.bootstrap(document,["app"])}(r.default,angular)},function(e,t,n){"use strict";var r=n(2),a=n(6),o=n(7),i=n(8),l=function(){function e(e){this.angular=e,this.start()}return e.prototype.start=function(){this.app=r.default.app,new a.default(this.app),new o.default(this.app),new i.default(this.app,this.angular)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=l},function(e,t,n){"use strict";var r=n(3),a=function(){function e(e){this.angular=e,this.injector=e.injector(),this.start()}return e.prototype.start=function(){var e=this;this.app=this.angular.module("app",["ngMaterial","ngRoute","ngAnimate","ngMessages"]),this.app.config(["$routeProvider","$locationProvider",function(e,t){e.when("/login",{templateUrl:"login.html",controller:"loginCtrl",controllerAs:"login"}).when("/list",{templateUrl:"keyList.html",controller:"listCtrl",controllerAs:"list",resolve:{test:["$q","keyManager",function(e,t){var n=e.defer();t.isAuthenticated()?n.resolve():window.location.hash="/login",n.promise}]}}).otherwise({redirectTo:"/login"}),t.html5Mode({enabled:!1,requireBase:!1})}]),this.app.config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("blue-grey").accentPalette("light-blue")}]),this.app.factory("keyManager",["$mdToast","$mdMedia","$mdDialog",function(t,n,a){e.mdToast=t,e.mdMedia=n,e.mdDialog=a;var o;return o||(o=new r.default,o.start()),o}]),this.app.directive("customOnChange",function(){return{restrict:"A",link:function(e,t,n){var r=e.$eval(n.customOnChange);t.bind("change",r)}}})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=new a(angular)},function(e,t,n){"use strict";function r(){var e,t=this,n="theBoss",r="keyObj";this.keyObj=Object.create(null),this.start=function(){t.aesManager=new a.default},this.setMasterKey=function(e){i(e)&&(l(e),u())},this.isAuthenticated=function(){var t="undefined"!=typeof e&&null!==e;return t},this.encryptKeyObj=function(){return t.aesManager.encrypt(e,JSON.stringify(t.keyObj))},this.encryptSave=function(n){var r={};if(null==n||void 0==n.title||0==n.title.length)o.default.toast("no title");else{if(!n.skip&&void 0!=t.keyObj[n.title])return void o.default.toast("title exists!");n.oldTitle&&n.title!==n.oldTitle&&s(n.oldTitle),r.type=parseInt(n.type),r.created=(new Date).getTime(),1==r.type?(r.user=t.aesManager.encrypt(e+r.created,n.user),r.pass=t.aesManager.encrypt(e+r.created,n.pass)):r.text=t.aesManager.encrypt(e+r.created,n.text),t.keyObj[n.title]=r,c()}},this.deleteSave=function(e){t.keyObj.hasOwnProperty(e)&&(delete t.keyObj[e],c(),o.default.toast("delete "+e))},this.decrypt=function(n,r){return t.aesManager.decrypt(e+n,r)},this.decryptKeyObj=function(n){return t.aesManager.decrypt(e,n)},this.saveKey=function(){c()};var i=function(e){if(e&&""!==e&&e.length>4){var r=localStorage.getItem(n);return null===r?(localStorage.setItem(n,t.aesManager.encrypt(e,n)),o.default.toast("Please notice your masterkey for relogin!"),!0):n===t.aesManager.decrypt(e,r)?(o.default.toast("hey!"),!0):(o.default.toastAction("Come on! Do you want reset your account?",function(){return localStorage.clear()}),!1)}return!1},l=function(t){e=t},c=function(){localStorage.setItem(r,JSON.stringify(t.keyObj))},u=function(){var e=JSON.parse(localStorage.getItem(r));null===e||(t.keyObj=e)},s=function(e){t.keyObj.hasOwnProperty(e)&&delete t.keyObj[e]}}var a=n(4),o=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t){"use strict";var n=function(){function e(){this.cryptoJS=CryptoJS}return e.prototype.encrypt=function(e,t){var n=this.cryptoJS.AES.encrypt(t,e).toString();return n},e.prototype.decrypt=function(e,t){var n="";try{n=this.cryptoJS.AES.decrypt(t,e).toString(this.cryptoJS.enc.Utf8)}catch(e){n=""}return n},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";var r=n(2),a=function(){function e(){}return e.prototype.toast=function(e){r.default.mdToast.showSimple(e)},e.prototype.toastAction=function(e,t){var n=r.default.mdToast.simple().textContent(e).action("YES").highlightAction(!0).hideDelay(0);r.default.mdToast.show(n).then(function(e){"ok"===e&&t()})},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=new a},function(e,t,n){"use strict";var r=n(5),a=function(){function e(e){this.start(e)}return e.prototype.start=function(e){var t=this;e.controller("mainController",["$scope","$mdSidenav","keyManager",function(e,n,r){e.toggleSidenav=function(e){n(e).toggle()},e.exportKey=function(){t.exportImpl(r,n)},e.importKey=function(){document.getElementById("upload-btn").click()},e.upload=function(e){t.uploadImp(e,r,n)}}])},e.prototype.exportImpl=function(e,t){var n=(e.keyObj,document.createElement("a"));n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e.encryptKeyObj())),n.setAttribute("download","AM-"+this.genarateDateStr()+".am"),document.body.appendChild(n),n.click(),document.body.removeChild(n),r.default.toast("export"),t("right").toggle()},e.prototype.uploadImp=function(e,t,n){var a=this,o=e.target,i=new FileReader;i.onload=function(){var e=JSON.parse(t.decryptKeyObj(i.result));a.mergeKeyObj(t.keyObj,e),t.saveKey(),r.default.toast("import"),n("right").toggle()},i.readAsText(o.files[0])},e.prototype.mergeKeyObj=function(e,t){for(var n in t){var r=t[n];if("undefined"==typeof e[n])e[n]=r;else{if(e[n].type===r.type&&e[n].created===r.created)continue;e[this.getNextAvailableTile(e,n)]=r}}},e.prototype.getNextAvailableTile=function(e,t){for(var n=1,r="("+n+")";void 0!==e[t+r];)n++,r="("+n+")";return t+r},e.prototype.genarateDateStr=function(){var e=new Date;return e.getFullYear()+this.format(e.getMonth()+1)+this.format(e.getDate())+this.format(e.getHours())+this.format(e.getMinutes())+this.format(e.getSeconds())},e.prototype.format=function(e){return e<10?"0"+e:""+e},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t){"use strict";var n=function(){function e(e){this.start(e)}return e.prototype.start=function(e){e.controller("loginCtrl",["$scope","$location","$rootScope","keyManager",function(e,t,n,r){n.logged=!1,n.appHeight=window.outerHeight,e.masterkey="",e.enter=function(){r.setMasterKey(e.masterkey),document.activeElement&&document.activeElement.blur(),r.isAuthenticated()&&(n.logged=!0,t.path("/list"))}}])},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,n){"use strict";var r=n(2),a=n(9),o=n(10),i=function(){function e(e,t){var n=this;this.start=function(e){e.controller("listCtrl",["$scope","keyManager",function(e,t){e.keySet=t.keyObj,n.keyManager=t,n._scope=e,e.goToKey=n.goToKey,e.optionClick=n.optionClick,e.addNew=n.addNew}])},this.goToKey=function(e,t,a){r.default.mdDialog.show({controller:o.default,templateUrl:"showKeyDialog.html",parent:n.angular.element(document.body),targetEvent:a,locals:{key:e,data:t}}).then(function(){},function(){})},this.optionClick=function(e,t,r,a){if(0==t){var o={};o.title=r,o.type=a.type,o.created=a.created,1==a.type?(o.user=n.keyManager.decrypt(a.created,a.user),o.pass=n.keyManager.decrypt(a.created,a.pass)):o.text=n.keyManager.decrypt(a.created,a.text),o.skip=!0,o.oldTitle=r,n._scope.addNew(e,o)}else n.keyManager.deleteSave(r)},this.addNew=function(e,t){var o=r.default.mdMedia("sm")||r.default.mdMedia("xs");r.default.mdDialog.show({controller:a.default,templateUrl:"newKeyDialog.html",parent:n.angular.element(document.body),targetEvent:e,fullscreen:o,locals:{keyObj:t}}).then(function(e){n.keyManager.encryptSave(e)},function(){})},this.start(e),this.angular=t}return e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";var r=n(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=["$scope","$rootScope","keyObj",function(e,t,n){e.keyObj=n||{type:1},e.appHeight=t.appHeight,e.cancel=function(){r.default.mdDialog.cancel()},e.save=function(){r.default.mdDialog.hide(e.keyObj)}}]},function(e,t,n){"use strict";var r=n(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=["$scope","keyManager","key","data",function(e,t,n,a){e.keyObjDis={},e.keyObjDis.title=n,e.keyObjDis.type=a.type,e.keyObjDis.created=a.created,1==a.type?(e.keyObjDis.user=t.decrypt(a.created,a.user),e.keyObjDis.pass=t.decrypt(a.created,a.pass)):e.keyObjDis.text=t.decrypt(a.created,a.text),e.cancel=function(){r.default.mdDialog.cancel()}}]}]);